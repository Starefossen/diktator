basePath: /api
definitions:
  models.APIResponse:
    properties:
      data: {}
      error:
        type: string
      message:
        type: string
    type: object
  models.AddFamilyMemberRequest:
    properties:
      displayName:
        type: string
      email:
        type: string
      familyId:
        type: string
      role:
        enum:
        - parent
        - child
        type: string
    required:
    - displayName
    - email
    - familyId
    - role
    type: object
  models.CreateWordSetRequest:
    properties:
      language:
        type: string
      name:
        type: string
      testConfiguration:
        additionalProperties: true
        type: object
      words:
        items:
          $ref: '#/definitions/models.WordInput'
        type: array
    required:
    - language
    - name
    - words
    type: object
  models.DisplayNameUpdateRequest:
    properties:
      displayName:
        maxLength: 100
        minLength: 1
        type: string
    required:
    - displayName
    type: object
  models.SaveResultRequest:
    properties:
      correctWords:
        type: integer
      incorrectWords:
        description: 'Deprecated: Use Words field for detailed information'
        items:
          type: string
        type: array
      mode:
        enum:
        - standard
        - dictation
        - translation
        type: string
      score:
        type: number
      timeSpent:
        type: integer
      totalWords:
        type: integer
      wordSetId:
        type: string
      words:
        description: Detailed information for each word in the test
        items:
          $ref: '#/definitions/models.WordTestResult'
        type: array
    required:
    - correctWords
    - mode
    - score
    - totalWords
    - wordSetId
    type: object
  models.Translation:
    properties:
      audioId:
        type: string
      audioUrl:
        type: string
      language:
        type: string
      text:
        type: string
      voiceId:
        type: string
    type: object
  models.UpdateWordSetRequest:
    properties:
      language:
        type: string
      name:
        type: string
      testConfiguration:
        additionalProperties: true
        type: object
      words:
        items:
          $ref: '#/definitions/models.WordInput'
        type: array
    required:
    - language
    - name
    - words
    type: object
  models.WordInput:
    properties:
      definition:
        type: string
      translations:
        items:
          $ref: '#/definitions/models.Translation'
        type: array
      word:
        type: string
    required:
    - word
    type: object
  models.WordTestResult:
    properties:
      attempts:
        description: Number of attempts made
        type: integer
      audioPlayCount:
        description: Number of times audio was played
        type: integer
      correct:
        description: Whether the word was answered correctly
        type: boolean
      errorTypes:
        description: Detected spelling error types (doubleConsonant, silentH, etc.)
        items:
          type: string
        type: array
      finalAnswer:
        description: The final answer provided
        type: string
      hintsUsed:
        description: Number of hints used (if applicable)
        type: integer
      timeSpent:
        description: Time spent on this word in seconds
        type: integer
      userAnswers:
        description: All answers the user provided for this word
        items:
          type: string
        type: array
      word:
        type: string
    type: object
host: localhost:8080
info:
  contact:
    email: support@diktator.app
    name: Diktator Support
    url: https://github.com/starefossen/diktator
  description: A family-friendly spelling test application API
  license:
    name: MIT
    url: https://github.com/starefossen/diktator/blob/main/LICENSE
  termsOfService: http://swagger.io/terms/
  title: Diktator API
  version: "1.0"
paths:
  /api/families:
    get:
      consumes:
      - application/json
      description: Get information about the user's family
      produces:
      - application/json
      responses:
        "200":
          description: Family information
          schema:
            $ref: '#/definitions/models.APIResponse'
        "401":
          description: Family access validation required
          schema:
            $ref: '#/definitions/models.APIResponse'
        "500":
          description: Service unavailable or failed to retrieve family
          schema:
            $ref: '#/definitions/models.APIResponse'
      security:
      - BearerAuth: []
      summary: Get Family Information
      tags:
      - families
  /api/families/children:
    get:
      consumes:
      - application/json
      description: Get all children in the authenticated user's family
      produces:
      - application/json
      responses:
        "200":
          description: List of family children
          schema:
            $ref: '#/definitions/models.APIResponse'
        "401":
          description: Family access validation required
          schema:
            $ref: '#/definitions/models.APIResponse'
        "500":
          description: Failed to retrieve children
          schema:
            $ref: '#/definitions/models.APIResponse'
      security:
      - BearerAuth: []
      summary: Get Family Children
      tags:
      - families
  /api/families/children/{childId}:
    delete:
      consumes:
      - application/json
      description: Delete a child account (parent only)
      parameters:
      - description: Child ID
        in: path
        name: childId
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Child account deleted successfully
          schema:
            $ref: '#/definitions/models.APIResponse'
        "401":
          description: Parent access required
          schema:
            $ref: '#/definitions/models.APIResponse'
        "404":
          description: Child not found
          schema:
            $ref: '#/definitions/models.APIResponse'
        "500":
          description: Failed to delete child account
          schema:
            $ref: '#/definitions/models.APIResponse'
      security:
      - BearerAuth: []
      summary: Delete Child Account
      tags:
      - children
    put:
      consumes:
      - application/json
      description: Update a child account's display name (parent only)
      parameters:
      - description: Child ID
        in: path
        name: childId
        required: true
        type: string
      - description: Display name update request
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/models.DisplayNameUpdateRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Child account updated successfully
          schema:
            $ref: '#/definitions/models.APIResponse'
        "400":
          description: Invalid request data
          schema:
            $ref: '#/definitions/models.APIResponse'
        "401":
          description: Parent access required
          schema:
            $ref: '#/definitions/models.APIResponse'
        "403":
          description: Not authorized to update this child
          schema:
            $ref: '#/definitions/models.APIResponse'
        "500":
          description: Failed to update child account
          schema:
            $ref: '#/definitions/models.APIResponse'
      security:
      - BearerAuth: []
      summary: Update Child Account
      tags:
      - children
  /api/families/children/{childId}/progress:
    get:
      consumes:
      - application/json
      description: Get progress data for a specific child
      parameters:
      - description: Child ID
        in: path
        name: childId
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Child progress data
          schema:
            $ref: '#/definitions/models.APIResponse'
        "401":
          description: Parent access required
          schema:
            $ref: '#/definitions/models.APIResponse'
        "404":
          description: Child not found
          schema:
            $ref: '#/definitions/models.APIResponse'
        "500":
          description: Failed to retrieve child progress
          schema:
            $ref: '#/definitions/models.APIResponse'
      security:
      - BearerAuth: []
      summary: Get Child Progress
      tags:
      - children
  /api/families/children/{childId}/results:
    get:
      consumes:
      - application/json
      description: Get test results for a specific child
      parameters:
      - description: Child ID
        in: path
        name: childId
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Child test results
          schema:
            $ref: '#/definitions/models.APIResponse'
        "401":
          description: Parent access required
          schema:
            $ref: '#/definitions/models.APIResponse'
        "404":
          description: Child not found
          schema:
            $ref: '#/definitions/models.APIResponse'
        "500":
          description: Failed to retrieve child results
          schema:
            $ref: '#/definitions/models.APIResponse'
      security:
      - BearerAuth: []
      summary: Get Child Results
      tags:
      - children
  /api/families/invitations:
    get:
      consumes:
      - application/json
      description: Get all invitations for the family (parent only)
      produces:
      - application/json
      responses:
        "200":
          description: Family invitations retrieved successfully
          schema:
            $ref: '#/definitions/models.APIResponse'
        "500":
          description: Failed to retrieve invitations
          schema:
            $ref: '#/definitions/models.APIResponse'
      security:
      - BearerAuth: []
      summary: Get Family Invitations
      tags:
      - families
  /api/families/invitations/{invitationId}:
    delete:
      consumes:
      - application/json
      description: Cancel/delete a pending invitation (parent only)
      parameters:
      - description: Invitation ID
        in: path
        name: invitationId
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Invitation deleted successfully
          schema:
            $ref: '#/definitions/models.APIResponse'
        "404":
          description: Invitation not found
          schema:
            $ref: '#/definitions/models.APIResponse'
        "500":
          description: Failed to delete invitation
          schema:
            $ref: '#/definitions/models.APIResponse'
      security:
      - BearerAuth: []
      summary: Delete Family Invitation
      tags:
      - families
  /api/families/members:
    post:
      consumes:
      - application/json
      description: |-
        Add a parent or child to the family. For parents, creates an invitation.
        For children, creates a pending account linked when they log in.
      parameters:
      - description: Family member details
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/models.AddFamilyMemberRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Member added or invited successfully
          schema:
            $ref: '#/definitions/models.APIResponse'
        "400":
          description: Invalid request data
          schema:
            $ref: '#/definitions/models.APIResponse'
        "403":
          description: Parent role required
          schema:
            $ref: '#/definitions/models.APIResponse'
        "500":
          description: Service unavailable or failed to add member
          schema:
            $ref: '#/definitions/models.APIResponse'
      security:
      - BearerAuth: []
      summary: Add Family Member
      tags:
      - families
  /api/families/members/{userId}:
    delete:
      consumes:
      - application/json
      description: Remove a parent or child from the family (parent only, cannot remove
        created_by parent)
      parameters:
      - description: User ID
        in: path
        name: userId
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Member removed successfully
          schema:
            $ref: '#/definitions/models.APIResponse'
        "400":
          description: Invalid request or cannot remove creator
          schema:
            $ref: '#/definitions/models.APIResponse'
        "404":
          description: Member not found
          schema:
            $ref: '#/definitions/models.APIResponse'
        "500":
          description: Failed to remove member
          schema:
            $ref: '#/definitions/models.APIResponse'
      security:
      - BearerAuth: []
      summary: Remove Family Member
      tags:
      - families
  /api/families/progress:
    get:
      consumes:
      - application/json
      description: Get progress data for all family members
      produces:
      - application/json
      responses:
        "200":
          description: Family progress data
          schema:
            $ref: '#/definitions/models.APIResponse'
        "401":
          description: Family access validation required
          schema:
            $ref: '#/definitions/models.APIResponse'
        "500":
          description: Failed to retrieve family progress
          schema:
            $ref: '#/definitions/models.APIResponse'
      security:
      - BearerAuth: []
      summary: Get Family Progress
      tags:
      - families
  /api/families/results:
    get:
      consumes:
      - application/json
      description: Get test results for all members of the authenticated user's family
      produces:
      - application/json
      responses:
        "200":
          description: Family test results
          schema:
            $ref: '#/definitions/models.APIResponse'
        "401":
          description: Family access validation required
          schema:
            $ref: '#/definitions/models.APIResponse'
        "500":
          description: Failed to retrieve family results
          schema:
            $ref: '#/definitions/models.APIResponse'
      security:
      - BearerAuth: []
      summary: Get Family Results
      tags:
      - families
  /api/families/stats:
    get:
      consumes:
      - application/json
      description: Get statistical data for the authenticated user's family
      produces:
      - application/json
      responses:
        "200":
          description: Family statistics
          schema:
            $ref: '#/definitions/models.APIResponse'
        "401":
          description: Family access validation required
          schema:
            $ref: '#/definitions/models.APIResponse'
        "500":
          description: Failed to retrieve family stats
          schema:
            $ref: '#/definitions/models.APIResponse'
      security:
      - BearerAuth: []
      summary: Get Family Statistics
      tags:
      - families
  /api/invitations/{invitationId}/accept:
    post:
      consumes:
      - application/json
      description: Accept a pending family invitation and join the family. For first-time
        users, this also links their OIDC identity to the family child account.
      parameters:
      - description: Invitation ID
        in: path
        name: invitationId
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Invitation accepted successfully
          schema:
            $ref: '#/definitions/models.APIResponse'
        "400":
          description: Invalid invitation ID
          schema:
            $ref: '#/definitions/models.APIResponse'
        "404":
          description: Invitation not found
          schema:
            $ref: '#/definitions/models.APIResponse'
        "500":
          description: Failed to accept invitation
          schema:
            $ref: '#/definitions/models.APIResponse'
      security:
      - BearerAuth: []
      summary: Accept Invitation
      tags:
      - invitations
  /api/invitations/pending:
    get:
      consumes:
      - application/json
      description: Get all pending invitations for the authenticated user's email
      produces:
      - application/json
      responses:
        "200":
          description: Pending invitations retrieved
          schema:
            $ref: '#/definitions/models.APIResponse'
        "500":
          description: Failed to retrieve invitations
          schema:
            $ref: '#/definitions/models.APIResponse'
      security:
      - BearerAuth: []
      summary: Get Pending Invitations
      tags:
      - invitations
  /api/users:
    post:
      consumes:
      - application/json
      description: Create a new user account after OIDC authentication
      parameters:
      - description: User creation request
        in: body
        name: request
        required: true
        schema:
          properties:
            displayName:
              type: string
            email:
              type: string
            familyName:
              type: string
            role:
              type: string
          type: object
      produces:
      - application/json
      responses:
        "201":
          description: User created successfully
          schema:
            $ref: '#/definitions/models.APIResponse'
        "400":
          description: Invalid request data
          schema:
            $ref: '#/definitions/models.APIResponse'
        "401":
          description: Auth identity not found in token
          schema:
            $ref: '#/definitions/models.APIResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/models.APIResponse'
      security:
      - BearerAuth: []
      summary: Create User
      tags:
      - users
  /api/users/me/name:
    patch:
      consumes:
      - application/json
      description: Update the current user's display name
      parameters:
      - description: Display name update request
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/models.DisplayNameUpdateRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Display name updated successfully
          schema:
            $ref: '#/definitions/models.APIResponse'
        "400":
          description: Invalid request data or display name validation failed
          schema:
            $ref: '#/definitions/models.APIResponse'
        "401":
          description: User not authenticated
          schema:
            $ref: '#/definitions/models.APIResponse'
        "500":
          description: Failed to update display name
          schema:
            $ref: '#/definitions/models.APIResponse'
      security:
      - BearerAuth: []
      summary: Update User Display Name
      tags:
      - users
  /api/users/profile:
    get:
      consumes:
      - application/json
      description: Get the current user's profile information
      produces:
      - application/json
      responses:
        "200":
          description: User profile data
          schema:
            $ref: '#/definitions/models.APIResponse'
        "401":
          description: User not authenticated
          schema:
            $ref: '#/definitions/models.APIResponse'
        "404":
          description: User not found - needs registration
          schema:
            $ref: '#/definitions/models.APIResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/models.APIResponse'
      security:
      - BearerAuth: []
      summary: Get User Profile
      tags:
      - users
  /api/users/results:
    get:
      consumes:
      - application/json
      description: Get test results for the authenticated user
      produces:
      - application/json
      responses:
        "200":
          description: Test results
          schema:
            $ref: '#/definitions/models.APIResponse'
        "401":
          description: User authentication required
          schema:
            $ref: '#/definitions/models.APIResponse'
        "500":
          description: Failed to retrieve test results
          schema:
            $ref: '#/definitions/models.APIResponse'
      security:
      - BearerAuth: []
      summary: Get Test Results
      tags:
      - users
    post:
      consumes:
      - application/json
      description: Save a test result for the authenticated user
      parameters:
      - description: Test result data
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/models.SaveResultRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Test result saved successfully
          schema:
            $ref: '#/definitions/models.APIResponse'
        "400":
          description: Invalid request data
          schema:
            $ref: '#/definitions/models.APIResponse'
        "401":
          description: User authentication required
          schema:
            $ref: '#/definitions/models.APIResponse'
        "500":
          description: Failed to save test result
          schema:
            $ref: '#/definitions/models.APIResponse'
      security:
      - BearerAuth: []
      summary: Save Test Result
      tags:
      - users
  /api/wordsets:
    get:
      consumes:
      - application/json
      description: Get word sets for the authenticated user's family
      produces:
      - application/json
      responses:
        "200":
          description: Word sets for the family
          schema:
            $ref: '#/definitions/models.APIResponse'
        "401":
          description: Family access validation required
          schema:
            $ref: '#/definitions/models.APIResponse'
        "500":
          description: Service unavailable or failed to retrieve word sets
          schema:
            $ref: '#/definitions/models.APIResponse'
      security:
      - BearerAuth: []
      summary: Get Word Sets
      tags:
      - wordsets
    post:
      consumes:
      - application/json
      description: Create a new word set for practice
      parameters:
      - description: Word set creation request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/models.CreateWordSetRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Word set created successfully
          schema:
            $ref: '#/definitions/models.APIResponse'
        "400":
          description: Invalid request data
          schema:
            $ref: '#/definitions/models.APIResponse'
        "401":
          description: User authentication required
          schema:
            $ref: '#/definitions/models.APIResponse'
        "500":
          description: Failed to create word set
          schema:
            $ref: '#/definitions/models.APIResponse'
      security:
      - BearerAuth: []
      summary: Create Word Set
      tags:
      - wordsets
  /api/wordsets/{id}:
    delete:
      consumes:
      - application/json
      description: Delete a word set by ID and all associated audio files from storage
      parameters:
      - description: Word Set ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Word set and audio files deleted successfully
          schema:
            $ref: '#/definitions/models.APIResponse'
        "400":
          description: Word set ID is required
          schema:
            $ref: '#/definitions/models.APIResponse'
        "404":
          description: Word set not found
          schema:
            $ref: '#/definitions/models.APIResponse'
        "500":
          description: Failed to delete word set
          schema:
            $ref: '#/definitions/models.APIResponse'
      security:
      - BearerAuth: []
      summary: Delete Word Set
      tags:
      - wordsets
    put:
      consumes:
      - application/json
      description: Update an existing word set name, words, and configuration. Audio
        will be regenerated automatically for new/changed words.
      parameters:
      - description: Word Set ID
        in: path
        name: id
        required: true
        type: string
      - description: Word set update request
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/models.UpdateWordSetRequest'
      produces:
      - application/json
      responses:
        "200":
          description: Word set updated successfully
          schema:
            $ref: '#/definitions/models.APIResponse'
        "400":
          description: Invalid request data or word set ID required
          schema:
            $ref: '#/definitions/models.APIResponse'
        "401":
          description: User authentication required
          schema:
            $ref: '#/definitions/models.APIResponse'
        "404":
          description: Word set not found
          schema:
            $ref: '#/definitions/models.APIResponse'
        "500":
          description: Failed to update word set
          schema:
            $ref: '#/definitions/models.APIResponse'
      security:
      - BearerAuth: []
      summary: Update Word Set
      tags:
      - wordsets
  /api/wordsets/{id}/assignments/{userId}:
    delete:
      consumes:
      - application/json
      description: Remove a word set assignment from a child user (parent only)
      parameters:
      - description: Word set ID
        in: path
        name: id
        required: true
        type: string
      - description: Child user ID
        in: path
        name: userId
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Word set unassigned successfully
          schema:
            $ref: '#/definitions/models.APIResponse'
        "400":
          description: Invalid request
          schema:
            $ref: '#/definitions/models.APIResponse'
        "403":
          description: Parent role required
          schema:
            $ref: '#/definitions/models.APIResponse'
        "500":
          description: Failed to unassign word set
          schema:
            $ref: '#/definitions/models.APIResponse'
      security:
      - BearerAuth: []
      summary: Unassign Word Set from User
      tags:
      - wordsets
    post:
      consumes:
      - application/json
      description: Assign a word set to a child user (parent only)
      parameters:
      - description: Word set ID
        in: path
        name: id
        required: true
        type: string
      - description: Child user ID
        in: path
        name: userId
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Word set assigned successfully
          schema:
            $ref: '#/definitions/models.APIResponse'
        "400":
          description: Invalid request
          schema:
            $ref: '#/definitions/models.APIResponse'
        "403":
          description: Parent role required
          schema:
            $ref: '#/definitions/models.APIResponse'
        "500":
          description: Failed to assign word set
          schema:
            $ref: '#/definitions/models.APIResponse'
      security:
      - BearerAuth: []
      summary: Assign Word Set to User
      tags:
      - wordsets
  /api/wordsets/{id}/words/{word}/audio:
    get:
      consumes:
      - application/json
      description: Stream TTS audio for a specific word in a word set (generates on-demand,
        cached by browser)
      parameters:
      - description: Word Set ID
        in: path
        name: id
        required: true
        type: string
      - description: Word to generate audio for
        in: path
        name: word
        required: true
        type: string
      produces:
      - audio/ogg
      responses:
        "200":
          description: Audio file content (OGG Opus)
          schema:
            type: file
        "400":
          description: Invalid request
          schema:
            $ref: '#/definitions/models.APIResponse'
        "404":
          description: Word set not found
          schema:
            $ref: '#/definitions/models.APIResponse'
        "500":
          description: Failed to generate audio
          schema:
            $ref: '#/definitions/models.APIResponse'
      summary: Stream Audio for Word
      tags:
      - wordsets
  /api/wordsets/voices:
    get:
      consumes:
      - application/json
      description: Get a list of available Text-to-Speech voices for a specific language
      parameters:
      - description: Language code (e.g., 'en', 'nb-NO')
        in: query
        name: language
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: List of available voices
          schema:
            allOf:
            - $ref: '#/definitions/models.APIResponse'
            - properties:
                data:
                  items: {}
                  type: array
              type: object
        "500":
          description: Failed to retrieve voices
          schema:
            $ref: '#/definitions/models.APIResponse'
      security:
      - BearerAuth: []
      summary: List available TTS voices
      tags:
      - wordsets
  /health:
    get:
      consumes:
      - application/json
      description: Returns the health status of the API
      produces:
      - application/json
      responses:
        "200":
          description: Health status
          schema:
            additionalProperties: true
            type: object
      summary: Health Check
      tags:
      - health
securityDefinitions:
  BearerAuth:
    description: 'OIDC JWT token. Format: "Bearer {token}"'
    in: header
    name: Authorization
    type: apiKey
swagger: "2.0"
